<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=utf-8">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:SimSun;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:Mangal;
	panose-1:2 4 5 3 5 2 3 3 2 2;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:"Liberation Serif";
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:"Lohit Devanagari";
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:"Liberation Sans";
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:OpenSymbol;
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:"\@SimSun";
	panose-1:2 1 6 0 3 1 1 1 1 1;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	text-autospace:ideograph-other;
	font-size:12.0pt;
	font-family:"Liberation Serif",serif;}
p.MsoCommentText, li.MsoCommentText, div.MsoCommentText
	{margin:0cm;
	margin-bottom:.0001pt;
	text-autospace:ideograph-other;
	font-size:10.0pt;
	font-family:"Liberation Serif",serif;}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{margin:0cm;
	margin-bottom:.0001pt;
	text-autospace:ideograph-other;
	font-size:12.0pt;
	font-family:"Liberation Serif",serif;}
p.MsoCaption, li.MsoCaption, div.MsoCaption
	{margin-top:6.0pt;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:0cm;
	text-autospace:ideograph-other;
	font-size:12.0pt;
	font-family:"Liberation Serif",serif;
	font-style:italic;}
p.MsoList, li.MsoList, div.MsoList
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:7.0pt;
	margin-left:0cm;
	line-height:115%;
	text-autospace:ideograph-other;
	font-size:12.0pt;
	font-family:"Liberation Serif",serif;}
p.MsoCommentSubject, li.MsoCommentSubject, div.MsoCommentSubject
	{margin:0cm;
	margin-bottom:.0001pt;
	text-autospace:ideograph-other;
	font-size:10.0pt;
	font-family:"Liberation Serif",serif;
	font-weight:bold;}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{margin:0cm;
	margin-bottom:.0001pt;
	text-autospace:ideograph-other;
	font-size:9.0pt;
	font-family:"Times New Roman",serif;}
p.MsoRMPane, li.MsoRMPane, div.MsoRMPane
	{margin:0cm;
	margin-bottom:.0001pt;
	text-autospace:ideograph-other;
	font-size:12.0pt;
	font-family:"Liberation Serif",serif;}
p.Standard, li.Standard, div.Standard
	{mso-style-name:Standard;
	margin:0cm;
	margin-bottom:.0001pt;
	text-autospace:ideograph-other;
	font-size:12.0pt;
	font-family:"Liberation Serif",serif;}
p.Heading, li.Heading, div.Heading
	{mso-style-name:Heading;
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:0cm;
	page-break-after:avoid;
	text-autospace:ideograph-other;
	font-size:14.0pt;
	font-family:"Liberation Sans",sans-serif;}
p.Textbody, li.Textbody, div.Textbody
	{mso-style-name:"Text body";
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:7.0pt;
	margin-left:0cm;
	line-height:115%;
	text-autospace:ideograph-other;
	font-size:12.0pt;
	font-family:"Liberation Serif",serif;}
p.Index, li.Index, div.Index
	{mso-style-name:Index;
	margin:0cm;
	margin-bottom:.0001pt;
	text-autospace:ideograph-other;
	font-size:12.0pt;
	font-family:"Liberation Serif",serif;}
span.BulletSymbols
	{mso-style-name:"Bullet Symbols";
	font-family:OpenSymbol;}
span.CommentTextChar
	{mso-style-name:"Comment Text Char";
	font-family:"Mangal",serif;}
span.CommentSubjectChar
	{mso-style-name:"Comment Subject Char";
	font-family:"Mangal",serif;
	font-weight:bold;}
span.BalloonTextChar
	{mso-style-name:"Balloon Text Char";
	font-family:"Times New Roman",serif;}
.MsoChpDefault
	{font-family:"Liberation Serif",serif;}
.MsoPapDefault
	{text-autospace:ideograph-other;}
 /* Page Definitions */
 @page WordSection1
	{size:612.0pt 792.0pt;
	margin:2.0cm 2.0cm 2.0cm 2.0cm;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>

</head>

<body lang=EN-US>

<div class=WordSection1>

<p class=Standard align=center style='text-align:center'><u><span
style='font-size:14.0pt'>Phase 3 – Protection Mechanisms</span></u></p>

<p class=Standard align=center style='text-align:center'>Trevor Lingle trl46,
Di Wu diw26, Aaron Wu faw21</p>

<p class=Standard>&nbsp;</p>

<p class=Standard>1. Purpose</p>

<p class=Standard>&nbsp;</p>

<p class=Standard>            To describe the mechanisms to be used in
protecting a file server service. The mechanisms being used are to combat
threats such as: Unauthorized Token Issuance, Token Modification/Forgery,
Unauthorized File Servers, and Information Leakage via Passive Monitoring.</p>

<p class=Standard>&nbsp;</p>

<p class=Standard>2. Mechanism Summary</p>

<p class=Standard>            <br>
            Unauthorized Token Issuance is prevented by first authenticating
the user with a user defined password derived from account creation. Passwords
are stored as hashes following encrypted key exchange.</p>

<p class=Standard>            Token Modification/Forgery is prevented by the
Group Server signing the key with their private key. The Group Server’s public
key is publicly distributed to the rest of the system to verify that the key
has not been Forged.</p>

<p class=Standard>            Unauthorized File Servers are prevented by the
Client sending a challenge encrypted with the stored File Server’s public key.
The File Server then proves itself by sending back the decrypted challenge.</p>

<p class=Standard>            Information Leakage is prevented by all
connections first undergoing a Diffie-Hellman exchange to create symmetric
keys. Those symmetric keys are then used to encrypt all further communications.</p>

<p class=Standard>            </p>

<p class=Standard>&nbsp;</p>

<p class=Standard>3. Language Clarification<br>
<br>
</p>

<p class=Standard>            File Server – The server storing and managing
files and verifies user access.</p>

<p class=Standard>            Group Server – The server managing user and group
lists and verifies list access.</p>

<p class=Standard>            Client – The client service used to make requests
to the group/file server.</p>

<p class=Standard>            User – The identifier for a client operator
within the group server which a token defines.</p>

<p class=Standard>            Client Operator – The one who operates the Client
(human input and/or automated script).</p>

<p class=Standard>            User Token – Shared object between the
group/client/file servers to identify the user accessing each system.</p>

<p class=Standard>            </p>

<p class=Standard>4. Mechanism Implementation<br>
<br>
</p>

<p class=Standard>            4.1 Threat 1 – Unauthorized Token Issuance<br>
<br>
</p>

<p class=Standard style='margin-left:71.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Threat Summary: Client requests are not to be trusted by the
group server without authentication of identity. Client requests may be
requesting the user token which the client operator is not the owner of. <br>
<br>
</p>

<p class=Standard style='margin-left:71.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Mechanism:</p>

<p class=Standard style='margin-left:89.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>◦<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Users will be authenticated by passwords following encrypted key
exchange (EKE) with the NIST recommendation of 8 character minimum enforced by
the Client. Setup and authentication goes as follows:<br>
<br>
</p>

<p class=Standard style='margin-left:107.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>▪<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>User Creation (Setup)</p>

<p class=Standard style='margin-left:125.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>C (Client) generates SHA-256 hash of their password W</p>

<p class=Standard style='margin-left:125.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Client <b>sends</b> a username U and {W}k<sub>G</sub> using Group
server’s public key k<sub>G</sub></p>

<p class=Standard style='margin-left:125.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Group Server <b>sends</b> the Client the values g and p</p>

<p class=Standard style='margin-left:125.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Group Server Stores U and W</p>

<p class=Standard style='margin-left:125.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Client stores g and p</p>

<p class=Standard style='margin-left:107.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>▪<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>Authentication</p>

<p class=Standard style='margin-left:125.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Client calculates g<sup>u</sup> mod p with a randomly generated
nonce u</p>

<p class=Standard style='margin-left:125.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Client calculates the SHA-256 hash of the password W</p>

<p class=Standard style='margin-left:125.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Client encrypts g<sup>u</sup> mod p with the hash as a key for
AES.</p>

<p class=Standard style='margin-left:125.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Client <b>sends</b> {g<sup>u</sup> mod p}W to the group server</p>

<p class=Standard style='margin-left:125.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Group Server generates g<sup>s</sup> mod p with a randomly
generated nonce s</p>

<p class=Standard style='margin-left:125.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Group Server calculates K = g<sup>su</sup> mod p</p>

<p class=Standard style='margin-left:125.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Group Server chooses a new random challenge C</p>

<p class=Standard style='margin-left:125.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Group Server encrypts g<sup>s</sup> mod p and C with W</p>

<p class=Standard style='margin-left:125.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Group Server <b>sends</b> {g<sup>s</sup> mod p, C}W to the Client</p>

<p class=Standard style='margin-left:125.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Client calculates K = g<sup>su</sup> mod p</p>

<p class=Standard style='margin-left:125.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Client <b>sends</b> {C}K to the Group Server</p>

<p class=Standard style='margin-left:125.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Group Server verifies C</p>

<p class=Standard style='margin-left:125.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Group Server generates SHA-256 hash of the User Token T, and
signs T</p>

<p class=Standard style='margin-left:125.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Group Server sends {[T]k<sub>G</sub><sup>-1</sup>, token}K<sup> </sup>to
the user on success</p>

<p class=Standard><img width=498 height=320 id="Picture 3"
src="Phase3-Writeup.fld/T1.png"
alt="A close up of text on a whiteboard&#10;&#10;Description automatically generated"></p>


<p class=Standard style='margin-left:89.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>◦<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Passwords will be saved on the group server in a lookup table
consisting of &lt;Username (U) , password hash W&gt; pairs.</p>

<p class=Standard style='margin-left:89.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>◦<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The prime p and generator g are at least 1024 bits constant, and
they are shared among all individuals/servers.</p>

<p class=Standard style='margin-left:89.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>◦<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Rather than signing the token, Group Server can sign the hashcode
of token for efficiency. Thus, a toString() method in UserToken class is
required to convert a token to a hashable string. The idea is padding each
field with 0s to make it reach a specific length.<br>
<br>
</p>

<p class=Standard style='margin-left:71.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Justification:</p>

<p class=Standard style='margin-left:89.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>◦<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span> It is assumed that only authorized Client Operators for User U
know the password to get W.</p>

<p class=Standard style='margin-left:89.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>◦<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>C is new for every authentication, therefore a replay attack
fails when the client sends an old { g<sup>u</sup> mod p }W due to not being
able to generate the new K.</p>

<p class=Standard style='margin-left:89.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>◦<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Setup and Authentication is encrypted (see 4.4) preventing W from
being exposed on account creation and is never sent again. This means that even
if the encryption wrapping communication is broken, then the attacker will not
gain knowledge about W (although will be able to see all other traffic
including token transfer).</p>

<p class=Standard style='margin-left:89.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>◦<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Since passive attackers can learn U, W, p, g and send the {g<sup>u</sup>
mod p}W to the server as well. It is essential to encrypt W using file server’s
public key at the setup phase</p>

<p class=Standard>&nbsp;</p>

<p class=Standard>            4.2 Threat 2 – Token Modification/Forgery</p>

<p class=Standard style='margin-left:71.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Threat Summary: Client operators may attempt to modify the user
tokens being sent and stored with the client in a way to impersonate another
user or gain non-distributed group access to their own user. <br>
<br>
</p>

<p class=Standard style='margin-left:71.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Mechanism: Private key signing using RSA key pairs will be used
to ensure that the token received by a Client is the unmodified token expected
by the Client Operator, and the File Server will be able to verify the User
Token originated from the Group Server. The User Token exchange between the
Client and Group Server and between Client and File Server would occur as
follows:<br>
<br>
</p>

<p class=Standard style='margin-left:89.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>◦<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The Group Server authenticates the client operator.</p>

<p class=Standard style='margin-left:89.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>◦<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>On successful authentication, the Group Server sends {[T]k<sub>G</sub><sup>-1</sup>,
token}K<sub>UG</sub> to the Client. </p>

<p class=Standard style='margin-left:107.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>▪<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>T is the hash of UserToken, k<sub>G</sub><sup>-1</sup> is the
private key of Group Server, K<sub>UG</sub> is the symmetric key between Client
and Group Server</p>

<p class=Standard style='margin-left:89.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>◦<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The Client sends {[T]k<sub>G</sub><sup>-1</sup>, token}K<sub>UF</sub>
to the File Server</p>

<p class=Standard style='margin-left:107.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>▪<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>K<sub>UG</sub> is the symmetric key between Client and File
Server</p>

<p class=Standard><img width=498 height=320 id="Picture 3"
src="Phase3-Writeup.fld/T2.png"
alt="A close up of text on a whiteboard&#10;&#10;Description automatically generated"></p>

<p class=Standard>&nbsp;</p>

<p class=Standard style='margin-left:71.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Justification:</p>

<p class=Standard style='margin-left:89.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>◦<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Rather than signing the token, Group Server can sign the hashcode
of token for efficiency. Thus, a toString() method in UserToken class is
required to convert a token to a hashable string. The idea is padding each
field with 0s to make it reach a specific length.</p>

<p class=Standard style='margin-left:89.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>◦<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Private key signing allows File Servers to verify that User Token
was created by the Group Server and did not get modified by Clients. File
Servers are able to compare the hash of User Token with decrypted [T]k<sub>G</sub><sup>-1</sup>.
If two hashes are different, it means User Token has been modified, and File
Server can reject the connection.<sup> </sup></p>

<p class=Standard style='margin-left:89.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>◦<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Any attempt to make changes to the [T]k<sub>G</sub><sup>-1 </sup>by
the Client would require knowledge of the Group Server’s private key which is
assumed to be secure. <br>
<br>
</p>

<p class=Standard>            4.3 Threat 3 – Unauthorized File Servers<br>
<br>
</p>

<p class=Standard style='margin-left:71.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Threat Summary: Client Operators should be confident that the
file server they attempt to connect to is legitimate. An client could initiate
a connect to a known server but instead be redirected to a malicious server
leading to leakage of the client operator’s files and or user token allowing
access to files on the non-malicious file server.<br>
<br>
</p>

<p class=Standard style='margin-left:71.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Mechanism: Access to a File Server will require the File Server’s
administrator to transfer the public key to the Client, and it is assumed the
Client has a stored mapping of File Servers to public keys. This mapping is
assumed to be correct.<br>
To authorize the file server, the Client and File Server go through a
Diffie-Hellman key exchange. The DH key exchange transportations are
encrypted/signed by File Server’s public key/private key:</p>

<p class=Standard style='margin-left:71.45pt'>&nbsp;</p>

<p class=Standard style='margin-left:89.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>◦<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Client chooses a new random number c.</p>

<p class=Standard style='margin-left:89.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>◦<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Client encrypts {g<sup>c</sup> mod p} k<sub>F</sub> with File
Server’s public key.</p>

<p class=Standard style='margin-left:89.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>◦<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>File Server chooses a new random number f, and compute K<sub>cf</sub>
= g<sup>cf</sup> mod p</p>

<p class=Standard style='margin-left:89.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>◦<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>File Server signs [g<sup>f</sup> mod p] k<sub>F</sub><sup>-1 </sup>with
File Server’s private key.</p>

<p class=Standard style='margin-left:89.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>◦<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>File Server sends a challenge nonce to the Client</p>

<p class=Standard style='margin-left:89.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>◦<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Client Sends back the Challenge and is compared validating the new keys</p>

<p class=Standard><img width=498 height=374 id="Picture 5"
src="Phase3-Writeup.fld/T3.png"
alt="A close up of text on a whiteboard&#10;&#10;Description automatically generated"></p>

<p class=Standard style='margin-left:71.45pt'><br>
<br>
</p>

<p class=Standard style='margin-left:71.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Justification:</p>

<p class=Standard style='margin-left:89.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>◦<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Only the File Server known by the Client will be able to decrypt
the {g<sup>u</sup> mod p} and sign the [g<sup>f</sup> mod p] correctly.</p>

<p class=Standard style='margin-left:89.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>◦<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>DH key exchange prevents information leakage between the client
and the File Servers</p>

<p class=Standard style='margin-left:89.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>◦<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The prime p and generator g are at least 1024 bits constant, and
they are shared among all individuals/servers.<br>
<br>
</p>

<p class=Standard>            4.4 Threat 4 – Information Leakage via Passive
Monitoring<br>
<br>
</p>

<p class=Standard style='margin-left:71.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Threat Summary: The communications between the File/Client/Group
servers may not be private such that any data sent across the network could be
viewed including user tokens and private file data. A malicious user could copy
the user token to take control of another client operator’s user or view
personal and private data over the wire.<br>
<br>
</p>

<p class=Standard style='margin-left:71.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Mechanism: Signed Diffie-Hellman will be used to prevent
information leakage between the client and the File/Group servers. Each Server
(File server/Group server) will have their own public/private RSA keypair. <b>For
Client and File Servers</b>, key exchange occurs at the phase of verifying File
Server (See T3). For Client and Group Server, key exchange occurs at the phase
of verifying Client (See T1). Exchanges will go as follows:<br>
<br>
</p>

<p class=Standard style='margin-left:89.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>◦<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The Client generates a random nonce (n<sub>c</sub>) which is used
to calculate g<sup>nc </sup>mod p</p>

<p class=Standard style='margin-left:89.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>◦<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The Server generates a random nonce (n<sub>s</sub>) which is used
to calculate g<sup>ns </sup>mod p</p>

<p class=Standard style='margin-left:89.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>◦<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The Client <b>sends</b> g<sup>nc </sup>mod p to the Server</p>

<p class=Standard style='margin-left:89.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>◦<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The Server <b>sends</b> g<sup>ns </sup>mod p to the Client</p>

<p class=Standard style='margin-left:89.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>◦<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The Client computes the symmetric key K<sub>cs</sub> = ([g<sup>nb
</sup>mod p]<sup>nc</sup> mod p)</p>

<p class=Standard style='margin-left:89.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>◦<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The Server computes the symmetric key K<sub>cs</sub> = ([g<sup>nc
</sup>mod p]<sup>ns</sup> mod p)</p>

<p class=Standard style='margin-left:89.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>◦<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Client and Server encrypt all communications sent using the
symmetric key K<sub>cs</sub></p>

<p class=Standard style='margin-left:70.9pt'><br>
New nonces n<sub><span style='font-size:11.0pt'>c </span></sub>n<sub>s</sub>
will be generated on each connect between a server and client preventing reuse
of the symmetric key K<sub>cs</sub>.</p>

<p class=Standard style='margin-left:70.9pt;text-indent:.55pt'>&nbsp;</p>

<p class=Standard style='margin-left:70.9pt'><br>
<br>
</p>

<p class=Standard style='margin-left:71.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Justification:</p>

<p class=Standard style='margin-left:89.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>◦<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Diffie-Hellman exchange allows for a symmetric key to be
generated without ever sending the key K<sub>cs</sub> over the network, and the
public information shared is not enough to easily determine the symmetric key.</p>

<p class=Standard style='margin-left:89.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>◦<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Using a symmetric key allows for large amounts of data to be
quickly encrypted/decrypted.</p>

<p class=Standard style='margin-left:89.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>◦<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>With lack of key reuse, information gained from previous sessions
will not be able to be used  </p>

<p class=Standard style='margin-left:89.45pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>◦<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>If a signed g<sup>n </sup>mod p was modified in traffic, or a
replay attack was attempted, then the value of K<sub>cs</sub> will not match
for both the Client and Server.</p>

<p class=Standard>&nbsp;</p>

<p class=Standard>5. Notes</p>

<p class=Standard style='margin-left:36.0pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The mechanisms described combat a malicious Client and passive
attackers, but assumes no part compromised and communications are neither
disrupted nor altered. Given a compromised Client, many of the security
features described above will not prevent an attacker from gaining access to
the compromised Client Operator’s User and in relation, their files; but, other
Users should not be considered compromised.</p>

<p class=Standard style='margin-left:36.0pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Compromised as used above is defined in that the functions of a
User are accessible from an unauthorized party.</p>

<p class=Standard style='margin-left:36.0pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The hash functions we mentioned above are all SHA-256</p>

<p class=Standard style='margin-left:36.0pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The block cipher algorithm we utilized are AES with CBC mode.</p>

<p class=Standard style='margin-left:36.0pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Public keys must be dispersed off band from trusted sources (a known system administrator
through signed email or physical transfer off a media device).</p>

<p class=Standard style='margin-left:36.0pt;text-indent:-18.0pt'><span
style='font-family:OpenSymbol'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>the g & p values are derived from the standardized java crypto library using the bouncy casle
provider.</p>

<p> 
Logging:

Group server provides secuity logs to enable auditing of the group server.
A timestamped record to track the changes to the group server's records of group and file lists.
Only those with access to the server will have access to the logs to protect privacy of those 
using the group server from the client application. 
</p>
</div>

</body>

</html>
